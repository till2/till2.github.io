---
layout: post
title:  "Unity ML-Agents"
author: "Till Zemann"
date:   2023-01-07 14:31:41 +0200
categories: jekyll update
comments: true
back_to_top_button: true
math: true
positive_reward: true
reward: 2
tags: [reinforcement learning]
thumbnail: "/images/ml_agents/thumbnail.png"
---


<div class="img-block" style="width: 500px;">
    <img src="/images/ml_agents/thumbnail.png"/>
</div>


<em style="float:right">First draft (Unity installation): 2023-01-07</em><br>
<em style="float:right">Second draft (Business plan): 2023-01-08</em><br>

<!--
### Contents
* TOC
{:toc}
-->


### Introduction

My motivations for trying this framework are:
- __generate some YouTube revenue__
- ML-Agents would be cool framework to test, because Unity project showcases are often more visually appealing compared to PyGame environments
- maybe I'll learn some C# along the way


### Features of a successful YouTube video

__Clickbaity title__:
- all CABS
- buzzwords, e.g. "INSANE"

__Simple and catchy thumbnail__:
- use bold, all-cabs text
- color: white, light green; black outline (example: AI Warehouse)
- maybe a red arrow to make the idea clear if necessary (example: AI Learns Insane Monopoly Strategies)

__Give the AI agents a cute voice__:
- [example video](https://youtu.be/LvZhRUsKNG4)

__Music__:
- light background music ("waiting music")
- dramatic/ orchestral music for "dramatic moments" (but only short, don't overdo it.)
- examples: MrBiest's videos, AI Warehouse

__Goal and actions__:
- make the goal really clear
- show what the AI can do (make the possible actions clear)

__Trim to only important/ emotional moments__:
- fast forward Symbol (cut only to the important parts)

__Commentary__:
- actual human commentary can tell a story and usually leads to better retention
- build a story (see "Alvin", who learns to beat increasingly difficult levels)

__Video schedule__:
- good timespan between videos: _2 weeks to 1 month_

__Risk__:
- if something fails it will probably become a one-hit-video and the videos afterwards will generate almost no clicks


### My idea

- channel name: __AI Sports__ 

- other possible channel names:
- AI plays sports
- AI Adventures
- if multiple agents coorporate/ interact to solve a goal, that would certainly be a banger video

There are many sports that an AI could potentially learn to play that would be fun to watch in a YouTube video. Some possibilities could include:

1. Soccer
2. Football
3. Basketball
4. Baseball
5. Tennis
6. Golf
7. Hockey
8. Volleyball
9. Rugby
10. Cricket
11. Snowboard, Ski
12. Skateboard
13. Surfing
14. Boxing
15. Parcour running
16. Dancing

Other ideas outside of the sports theme:

1. Drive cars (racing)
2. Cook and Bake Delicious Meals and Treats
3. Minigames
4. Solve Mystery & Crime cases
5. Design Architecture & Structures
6. Play musical instruments
7. Design clothing and accessories
8. Become an Expert Gardener and Landscaper

- title format: "AI Trains Itself to Become an Expert Skateboarder" 


### What can I do?

- train the agents and cut the video


### What should I outsource?

Outsource to Fiver:
- building an attractive (simple) interactive world and models for the agents in unity for the agents to learn in
- build a camera in unity
- [Fiver Link](https://www.fiverr.com/im_junaidiqbal/develop-unity-2d-and-3d-game?context_referrer=search_gigs&source=top-bar&ref_ctx_id=b726d9bd71bcaaaf04b88d0ba21a9f64&pckg_id=1&pos=8&context_type=auto&funnel=b726d9bd71bcaaaf04b88d0ba21a9f64&imp_id=92a8cdea-7e04-4ec2-b351-d9d53dba7024)

Outsource to ChatGPT:
- write a compelling story


### Production costs

- ~ 50-150€ for map and character model creation on Fiver.
- ~ 50€ for PremierePro & Photoshop (avaliable for Linux?)


### Expected return

~ 3000$ for 1M views on YouTube.

<div class="table-wrap">
    <table class="table">
        <tr>
            <td><strong>Video title</strong></td>
            <td><strong>Views</strong></td>
            <td><strong>Approx. return</strong></td>
            <td><strong>Link</strong></td>
        </tr>
        <tr>
        	<td><strong>AI Learns to Escape (using Reinforcement Learning)</strong></td>
        	<td>3M views</td>
        	<td><strong>9000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=v3UBlEJDXR0">Link</a></td>
        </tr>
		<tr>
        	<td><strong>A.I. Learns to Drive From Scratch in Trackmania</strong></td>
        	<td>6M views</td>
        	<td><strong>18000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=SX08NT55YhA&t=7s">Link</a></td>
        </tr>
		<tr>
        	<td><strong>AI Learns to Park - Deep Reinforcement Learning</strong></td>
        	<td>3M views</td>
        	<td><strong>9000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=VMp6pq6_QjI&t=85s">Link</a></td>
        </tr>
		<tr>
        	<td><strong>Deep Learning Cars <em>(comment: 2D from above)</em></strong></td>
        	<td>9M views</td>
        	<td><strong>27000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=Aut32pR5PQA">Link</a></td>
        </tr>
		<tr>
        	<td><strong>A.I. teaches itself to drive in Trackmania</strong></td>
        	<td>4M views</td>
        	<td><strong>12000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=a8Bo2DHrrow">Link</a></td>
        </tr>
		<tr>
        	<td><strong>TwoMinutePapers: OpenAI Hide&Seek</strong></td>
        	<td>9M views</td>
        	<td><strong>27000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=Lu56xVlZ40M">Link</a></td>
        </tr>
		<tr>
        	<td><strong>A genetic algorithm learns how to fight!  <em>(comment: super simple but good motivated story)</em></strong></td>
        	<td>3M views</td>
        	<td><strong>9000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=u2t77mQmJiY">Link</a></td>
        </tr>
		<tr>
        	<td><strong>b2studios - AI Learns Insane Monopoly Strategies</strong></td>
        	<td>8M views</td>
        	<td><strong>24000$</strong></td>
        	<td><a href="https://www.youtube.com/watch?v=dkvFcYBznPI">Link</a></td>
        </tr>
	</table>
</div>


<!--------------- UNITY ------------------>

### Unity Installation Process

1. Install UnityHub
2. Download the [ML-Agents GitHub repo](https://github.com/Unity-Technologies/ml-agents/)
3. Create a new Project of type "3D"
4. Open the package manager (in Window/Package Manager)

	<div class="img-block" style="width: 1000px;">
	    <img src="/images/ml_agents/package_manager.png"/>
	</div>

5. In the package manager, click on the settings wheel (top right), go to "Advanced Project Settings" and enable pre-release packages so that your're able to find the ML-Agents package
6. In the package manager, change from "Packages: In Project" to "Packages: Unity Registry"
7. In the package manager, find the ML Agents package and install it
8. In the package manager, go to "add package from disk" and open ml-agents-release_20/com.unity.ml-agents/package.json
10. In the package manager, go to "add package from disk" and open ml-agents-release_20/com.unity.ml-agents.extensions/package.json

11. Drag and drop the "ML-Agents" folder from the ML-Agents repo into the Unity "Assets" folder under "Project"

	<div class="img-block" style="width: 500px;">
	    <img src="/images/ml_agents/assets.png"/>
	</div>

12. To solve the compiler errors, there is one environment (PushBlockwithInput) that is a little buggy (Source: [2]). To delete it, go to Examples and just delete the PushBlockwithInput folder. The warnings should disappear now.


### Testing stuff

Showcasing different pretrained agents is really simple now. Just go to any Example, double click on a scene in the "Scenes" folder and click on play (top).

### Record video

1. First, install "Cinemachine" and "Recorder" in the package manager.
2. Open a timeline in Windows/Sequencing/Timeline (drag it into the tabs at the bottom next to the "Project" and "Console" tabs)
(didn't get further for now.) Link to tutorial: [The True Duck - Exporting Unity Scenes as Video](https://www.youtube.com/watch?v=AIlDJoCuJ1E)

Or just record in Unity with OBS:

<video width="600" height="350" controls src="/images/ml_agents/crawler_showcase.mp4"></video>

<p class="vspace"></p>



<!-- In-Text Citing -->
<!-- 
You can...
- use bullet points
1. use
2. ordered
3. lists


-- Math --
$\hat{s} = \frac{1}{n-1} \sum_{i=1}^{n} (x_i - \mu)^2$ 

-- Images --
<div class="img-block" style="width: 800px;">
    <img src="/images/lofi_art.png"/>
    <span><strong>Fig 1.1.</strong> Agent and Environment interactions</span>
</div>

-- Links --
[(k-fold) Cross-Validation](https://scikit-learn.org/stable/modules/cross_validation.html)

{% highlight python %}
@jit
def f(x)
    print("hi")
# does cool stuff
{% endhighlight %}

-- Highlights --
AAABC `ASDF` __some bold text__

-- Colors --
The <strong style="color: #1E72E7">joint distribution</strong> of $X$ and $Y$ is written as $P(X, Y)$.
The <strong style="color: #ED412D">marginal distribution</strong> on the other hand can be written out as a table.
-->

<!-- uncomment, when i understand more of the algorithms presented (missing DDPG, SAC, TD3, TRPO, PPO, Dyna-Q)
### Rl-Algorithms-Taxonomy in a Venn-Diagram

<div class="img-block" style="width: 700px;">
    <img src="/images/actor-critic/venn-diagram-rl-algos-detailed.png"/>
</div>

-->

### References 
1. Thumbnail taken from the [Unity machine-learning-agents website][thumbnail]
2. [Viraj Vaitha: Installation guide blogpost][installation-guide-blogpost]
3. [Sebastian Schuchmann: Unity ML-Agents 1.0 - Training your first A.I][installation-yt-video] (YouTube installation guide)

<!-- Ressources -->
[thumbnail]: https://unity.com/products/machine-learning-agents
[installation-guide-blogpost]: https://virajvaitha.medium.com/unity-ml-agents-2022-installation-e8af1eab2dd
[installation-yt-video]: https://youtu.be/_9aPZH6pyA8

<!-- Optional Comment Section-->
{% if page.comments %}
<p class="vspace"></p>
<a class="commentlink" role="button" href="/comments/">Share your thoughts.</a> <!-- role="button"  -->
{% endif %}

<!-- Optional Back to Top Button -->
{% if page.back_to_top_button %}
<script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
<script>addBackToTop({
  diameter: 40,
  backgroundColor: 'rgb(255, 255, 255, 0.7)', /* 30,144,255, 0.7 */
  textColor: '#4a4946'
})</script>
{% endif %}
